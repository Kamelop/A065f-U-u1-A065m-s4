#include <dt-bindings/phy/phy.h>
#include <dt-bindings/iio/mt635x-auxadc.h>

&lk_charger {
    max_charger_voltage = <10400000>;
    ac_charger_input_current = <1500000>;

    /* battery temperature protection */
    temp_t4_threshold = <50>;
    temp_t3_threshold = <45>;
    temp_t2_threshold = <12>;
    temp_t1_threshold = <5>;
    temp_t0_threshold = <0>;
};

&charger {
    io-channels = <&pmic_auxadc AUXADC_VCDT>;
    io-channel-names = "pmic_vbus";

    max_charger_voltage = <10400000>;
    charger_voltage_drop = <700000>;

    /* common */
    battery_cv = <4450000>;

    /* charging current */
    ac_charger_current = <2000000>;
    ac_charger_input_current = <1550000>;

    /* sw jeita */
    enable_sw_jeita;
    jeita_temp_above_t4_cv = <4250000>;
    jeita_temp_t3_to_t4_cv = <4250000>;
    jeita_temp_t2_to_t3_cv = <4450000>;
    jeita_temp_t1_to_t2_cv = <4450000>;
    jeita_temp_t0_to_t1_cv = <4450000>;
    jeita_temp_below_t0_cv = <4450000>;
    jeita_temp_above_t4_cur = <0>;
    jeita_temp_t3_to_t4_cur = <3000000>;
    jeita_temp_t2_to_t3_cur = <3000000>;
    jeita_temp_t1_to_t2_cur = <1320000>;
    jeita_temp_t0_to_t1_cur = <420000>;
    jeita_temp_below_t0_cur = <0>;
    temp_t4_thres = <52>;
    temp_t4_thres_minus_x_degree = <50>;
    temp_t3_thres = <42>;
    temp_t3_thres_minus_x_degree = <40>;
    temp_t2_thres = <15>;
    temp_t2_thres_plus_x_degree = <17>;
    temp_t1_thres = <8>;
    temp_t1_thres_plus_x_degree = <10>;
    temp_t0_thres = <0>;
    temp_t0_thres_plus_x_degree = <2>;
    temp_neg_10_thres = <0>;
    /*A06_V code for SR-AL7160V-01-163 by xiongxiaoliang at 20240912 start*/
    gxy-batt-aging-enable;
    gxy-cv-ranges = <0 199 4450000
                200 249 4430000
                250 299 4410000
                300 1000 4390000
                1001 9999 4340000>;
    /*A06_V code for SR-AL7160V-01-163 by xiongxiaoliang at 20240912 end*/
};

/*A06_V code for SR-AL7160V-01-139 by xiongxiaoliang at 20240906 start*/
&pdc {
    pd_vbus_upper_bound = <10000000>;
    pd_stop_battery_soc = <100>;
    /* single charger */
    sc_input_current = <1700000>;
    sc_charger_current = <2700000>;
    /* dual charger */
    vbat_threshold = <4450>;
};
/*A06_V code for SR-AL7160V-01-139 by xiongxiaoliang at 20240906 end*/

&i2c7 {
    upm6922-charger {
        compatible = "up,upm6922_charger";
        status = "okay";
        reg = <0x6b>;
        up,intr_gpio = <&pio 20 0>;

        up,upm6922,ichg = <500>;              /* unit:1mA */
        up,upm6922,iprechg = <420>;            /* unit:1mA */
        up,upm6922,iterm = <240>;              /* unit:1mA */
        up,upm6922,vreg = <4400>;              /* unit:1mV */
        up,upm6922,vindpm = <4600>;            /* unit:1mV */
        up,upm6922,boostv = <5000>;            /* unit:1mV */
        up,upm6922,boosti = <1200>;            /* unit:1mA */
        /*A06_V code for SR-AL7160V-01-134 by xiongxiaoliang at 20240830 start*/
        up,upm6922,vac-ovp = <11000>;          /* unit:1mV */
        /*A06_V code for SR-AL7160V-01-134 by xiongxiaoliang at 20240830 end*/
        //up,upm6922,continuous-adc-enable;
        phys = <&u2port0 PHY_TYPE_USB2>;
        phy-names = "usb2-phy";
        usb = <&usb>;
    };

    /*A06_V code for SR-AL7160V-01-131 by xiongxiaoliang at 20240827 start*/
    sgm41513 {
        status = "okay";
        compatible = "sgm,sgm41513";
        reg = <0x1A>;

        interrupt-parent = <&pio>;
        interrupts = <20 IRQ_TYPE_EDGE_FALLING>;
        /*A06_V code for SR-AL7160V-01-138 by xiongxiaoliang at 20240910 start*/
        sgm,intr_gpio = <&pio 20 0x0>;
        /*A06_V code for SR-AL7160V-01-138 by xiongxiaoliang at 20240910 end*/
        input-current-limit-microamp = <2400000>;
        phys = <&u2port0 PHY_TYPE_USB2>;
        phy-names = "usb2-phy";
        usb = <&usb>;
    };
    /*A06_V code for SR-AL7160V-01-131 by xiongxiaoliang at 20240827 end*/
    /*A06_V code for SR-AL7160V-01-134 by xiongxiaoliang at 20240830 start*/
    /*charger pump*/
    upm6720-charger@65{
        status = "okay";
        compatible = "unisemipower,upm6720-standalone";
        reg = <0x65>;		//I2C1 SENSOR_I2C
        upm6720,irq-gpio = <&pio 7 0>;
        upm6720,bat-ovp-disable = <0>;
        upm6720,bat-ocp-disable  = <0>;
        /* A06 code for AL7160A-1466 by liufurong at 20240525 start */
        // upm6720,bus-ucp-disable  = <0>;
        // upm6720,bus-rcp-disable  = <0>;
        /* A06 code for AL7160A-1466 by liufurong at 20240525 end */
        upm6720,vout-ovp-disable = <0>;
        upm6720,tdie-flt-disable;
        upm6720,tsbus-flt-disable;
        upm6720,tsbat-flt-disable;
        upm6720,wdt-disable;
        upm6720,vbus-errhi-disable;
        upm6720,bat-ovp-threshold = <4525>;			/* unit: 1mV */
        upm6720,bat-ocp-threshold = <8200>;			/* unit: 1mA */
        upm6720,bus-ovp-threshold = <11000>;		/* unit: 1mV */
        upm6720,bus-ocp-threshold = <5100>;			/* unit: 1mA */
        upm6720,bus-ucp-threshold = <250>;			/* unit: 1mA */
        upm6720,bus-rcp-threshold = <300>;			/* unit: 1mA */
        /* A06 code for AL7160A-1417 by jiashixian at 20240522 start*/
        upm6720,vac1-ovp-threshold = <12000>;		/* unit: 1mV */
        upm6720,vac2-ovp-threshold = <12000>;		/* unit: 1mV */
        /* A06 code for AL7160A-1417 by jiashixian at 20240522 end*/
        upm6720,vout-ovp-threshold = <5000>;		/* unit: 1mV */
        upm6720,tdie-flt-threshold = <140>;			/* unit: 1℃ */
        upm6720,tsbus-flt-threshold = <4102>;		/* unit: 0.001% */
        upm6720,tsbat-flt-threshold = <4102>;		/* unit: 0.001% */

        // upm6720,bat-ovp-mask;
        // upm6720,bat-ocp-mask;
        // upm6720,bus-ovp-mask;
        // upm6720,bus-ocp-mask;
        // upm6720,bus-ucp-mask;
        // upm6720,bus-rcp-mask;
        // upm6720,vout-ovp-mask;
        // upm6720,vac1-ovp-mask;
        // upm6720,vac2-ovp-mask;
        // upm6720,vout-present-mask;
        // upm6720,vac1-present-mask;
        // upm6720,vac2-present-mask;
        // upm6720,vbus-present-mask;
        // upm6720,acrb1-config-mask;
        // upm6720,acrb2-config-mask;
        // upm6720,cfly-short-mask;
        // upm6720,adc-done-mask;
        // upm6720,ss-timeout-mask;
        // upm6720,tsbus-flt-mask;
        // upm6720,tsbat-flt-mask;
        // upm6720,tdie-flt-mask;
        // upm6720,wd-mask;
        // upm6720,regn-good-mask;
        // upm6720,conv-active-mask;
        // upm6720,vbus-errhi-mask;
        // upm6720,bat-ovp-alm-disable;
        // upm6720,bat-ocp-alm-disable;
        // upm6720,bat-ucp-alm-disable;
        // upm6720,bus-ovp-alm-disable;
        // upm6720,tdie-alm-disable;
        upm6720,bat-ovp-alm-threshold = <4510>;		/* unit: 1mV */
        upm6720,bat-ocp-alm-threshold = <8000>;		/* unit: 1mA */
        upm6720,bat-ucp-alm-threshold = <0>;		/* unit: 1mA */
        upm6720,bus-ovp-alm-threshold = <11000>;	/* unit: 1mV */
        upm6720,bus-ocp-alm-threshold = <4000>;		/* unit: 1mA */
        upm6720,tdie-alm-threshold = <125>;			/* unit: 1℃ */
        // upm6720,bat-ovp-alm-mask;
        // upm6720,bat-ocp-alm-mask;
        // upm6720,bat-ucp-alm-mask;
        // upm6720,bus-ovp-alm-mask;
        // upm6720,bus-ocp-alm-mask;
        // upm6720,tsbus-tsbat-alm-mask;
        // upm6720,tdie-alm-mask;
        // upm6720,bus-pulldown-en;
        // upm6720,vac1-pulldown-en;
        // upm6720,vac2-pulldown-en;
        upm6720,sense-resistor-mohm = <5>;	/* unit: 1mohm */
        upm6720,ss-timeout = <10000>;		/* unit: 1ms */
        upm6720,wdt-set = <30000>;			/* unit: 1ms */
        upm6720,chg-config-1 = <1>;
        upm6720,fsw-set = <500>;
        upm6720,freq-shift = <0>;
        upm6720,ibus-ucp-fall-dg-sel = <0>;
        upm6720,adc-enable;
        upm6720,adc-rate = <0>;
        upm6720,adc-avg = <0>;
        upm6720,adc-avg-init = <0>;
        upm6720,adc-sample-bit = <0>;
        // upm6720,ibus-adc-disable;
        // upm6720,vbus-adc-disable;
        // upm6720,vac1-adc-disable;
        // upm6720,vac2-adc-disable;
        // upm6720,vout-adc-disable;
        // upm6720,vbat-adc-disable;
        // upm6720,ibat-adc-disable;
        // upm6720,tsbus-adc-disable;
        // upm6720,tsbat-adc-disable;
        // upm6720,tdie-adc-disable;
    };

    /*A06_V code for SR-AL7160V-01-135|SR-AL7160V-01-136 by xiongxiaoliang at 20240902 start*/
    nu2115a@6d{
        compatible = "nuvolta,nu2115a-standalone";
        status = "okay";
        reg = <0x6d>;
        nu2115a,intr_gpio = <&pio 7 0>;
        nuvolta,nu2115a,bat-ovp-disable = <0>;
        nuvolta,nu2115a,bat-ocp-disable = <0>;
        nuvolta,nu2115a,bus-ocp-disable = <0>;
        nuvolta,nu2115a,bat-ovp-threshold = <4575>;
        nuvolta,nu2115a,bat-ocp-threshold = <8000>;
        nuvolta,nu2115a,bus-ovp-threshold = <11000>;
        nuvolta,nu2115a,bus-ovp-alarm-threshold = <11000>;
        nuvolta,nu2115a,bus-ocp-threshold = <4000>;
        nuvolta,nu2115a,bus-ocp-alarm-threshold = <3500>;
        nuvolta,nu2115a,ac-ovp-threshold = <11000>;
        nuvolta,nu2115a,sense-resistor-mohm = <5>;
    };

    sgm41606S: sgm41606S@69 {
        status = "okay";
        compatible = "sgm,sgm41606S-standalone";
        reg = <0x69>;
        sgm41606S,intr_gpio = <&pio 7 0>;     //irq num base on hardware design
        sgm,sgm41606S,vbat-ovp-dis = <0>;
        sgm,sgm41606S,vbat-ovp = <105>; //3.5V+ BATOVP [6:0]*0.01V
        sgm,sgm41606S,vbat-ovp-alm = <105>; // 3.5V+BUSOVPALM[6:0]*0.01V  3.5V(0000000) – 4.77V(1111111)
        sgm,sgm41606S,ibat-ocp-dis = <0>;
        sgm,sgm41606S,ibat-ocp  = <81>; //BATOCP < 8.5A,[6:0]*0.1A;>8.5A,8.5A+(BATOCP[6:0]-1010101b) *0.3A
        sgm,sgm41606S,ibat-ocp_alm = <81>; //BATOCP_ALM[6:0]*0.1A
        //sgm,sgm41606S,vac-ovp-en = <0>;
        /* A06 code for AL7160A-1417 by jiashixian at 20240522 start*/
        sgm,sgm41606S,vac-ovp = <2>;//000 = 6.5V,001 = 10.5V,010 = 12V,011 = 14V,100 = 16V,101 = 18V
        sgm,sgm41606S,vac2-ovp = <2>;//000 = 6.5V,001 = 10.5V,010 = 12V,011 = 14V,100 = 16V,101 = 18V
        /* A06 code for AL7160A-1417 by jiashixian at 20240522 end*/
        //sgm,sgm41606S,vbus-ovp-en = <0>;
        sgm,sgm41606S,vbus-ovp = <80>; // 7V+BUSOVP[6:0]*0.05V  7V(0000000) – 12.75V(1110011)
        sgm,sgm41606S,vbus-ovp-alm = <80>; // 7V+BUSOVPALM[6:0]*0.05V  7V(0000000) – 12.75V(1110011)
        sgm,sgm41606S,tdie-flt-dis = <1>;
        /* A06 code for AL7160A-2699 by jiashixian at 20240607 start*/
        sgm,sgm41606S,vbus-ucp-dis = <0>;
        sgm,sgm41606S,vbus-ucp = <1>;
        sgm,sgm41606S,vbus-rcp-dis = <0>;
        /* A06 code for AL7160A-2699 by jiashixian at 20240607 end*/
        sgm,sgm41606S,vbus-high-dis = <1>;
        sgm,sgm41606S,ibus-ocp  = <14>; // 1A+BUSOCP[4:0]*0.25A ,1A (00000) – 6.5A (10110)
        sgm,sgm41606S,ibat-ucp-dis = <0>;
        sgm,sgm41606S,ibat-ucp-alm = <40>; /*0~4.5A,BATUCP_ALM[6:0]*0.05A*/
        sgm,sgm41606S,tsbus-flt-dis = <1>;/*0:enable 1:disable*/
        sgm,sgm41606S,tsbat-flt-dis = <1>;/*0:enable 1:disable*/
        sgm,sgm41606S,vbus-low-en = <1>;
        sgm,sgm41606S,vbus-high-en = <1>;

        sgm,sgm41606S,fsw-set = <2>;/*0:187.5kHz 1:250 2:300 3:375 4:500 5:750 6:1000 7:1500*/
        sgm,sgm41606S,wdt-dis = <1>;
        sgm,sgm41606S,wd-timeout = <3>; /*0:0.5s 1:1s 2:2s 3:5s 4:10s 5:20s 6:40s 7:80s*/
        sgm,sgm41606S,chg-en = <0>;
        sgm,sgm41606S,mode = <0>; /*0:off 1:bypass */
        sgm,sgm41606S,rsns = <1>; /*0:2mohm 1:5mohm*/
        sgm,sgm41606S,voutovp-dis = <1>;
        sgm,sgm41606S,enable-adc = <1>;/*0:disable 1:enable*/
        sgm,sgm41606S,enable-vac1-adc = <0>;/*0:enable 1:disable*/
    };

    nx853x-charger@61{
        compatible = "southchip,nx853x-standalone";
        reg = <0x61>;
        nx853x,intr_gpio = <&pio 7 0x0>; /* GPIO */
        charger_name = "primary_dvchg";
        charger_name_v4_19 = "primary_divider_chg";

        sc,nx853x,vbat-ovp-dis = <0>;
        sc,nx853x,vbat-ovp = <80>; /*3840 + val * 10*/
        sc,nx853x,ibat-ocp-dis = <0>;
        sc,nx853x,ibat-ocp = <82>; /*val * 100*/
        sc,nx853x,vbus-ovp-dis = <0>;
        sc,nx853x,vbus-ovp = <7>; /*9250 + val * 250*/
        sc,nx853x,vac-ovp-dis = <0>;
        sc,nx853x,vac-ovp = <1>; /*0:6.5V 1:11V 2:12V 3:13V 4:14V 5~7:15V*/
        sc,nx853x,ibus-ocp-dis = <0>;
        sc,nx853x,ibus-ocp = <100>; /*val * 50*/
        sc,nx853x,pmid2out-ovp-dis = <0>;
        /* A06 code for AL7160A-2699 by jiashixian at 20240607 start*/
        sc,nx853x,pmid2out-ovp = <7>; /*400 + val * 100*/
        /* A06 code for AL7160A-2699 by jiashixian at 20240607 end*/
        sc,nx853x,pmid2out-uvp-dis = <0>;
        /* A06 code for AL7160A-2699 by jiashixian at 20240607 start*/
        sc,nx853x,pmid2out-uvp = <7>; /*100 + val * 50*/
        /* A06 code for AL7160A-2699 by jiashixian at 20240607 end*/
        sc,nx853x,ibatreg = <0>; /*200 + val * 100*/
        sc,nx853x,ibusreg = <0>; /*100 + val * 50*/
        sc,nx853x,vbatreg = <0>; /*50 + val * 50*/
        sc,nx853x,tdiereg = <1>; /*0:90°C 1:100°C 2:110°C 3:120°C*/
        sc,nx853x,them-flt = <24>; /*val * 25*/
        sc,nx853x,ibat-sns-res = <1>; /*0:2hmo 1:5hmo*/
        sc,nx853x,pmid-pd-en = <0>;
        sc,nx853x,vbus-pd-en = <0>;
        sc,nx853x,work-mode = <0>; /*0: 2:1charge   1: 1:1charge 2: 1:2converte 3: 1:1converte*/
        sc,nx853x,ss-timeout = <7>; /*0:disable 1:10ms 2:20ms 3:400ms, 4:80ms 5:320ms 6:1.28s 7:10.24s*/
        sc,nx853x,wd-timeout-dis = <1>;
        sc,nx853x,wd-timeout = <0>; /*0:0.5s 1:1s 2:5s 3:30s*/
        sc,nx853x,vout-ovp-dis = <0>;
        sc,nx853x,vout-ovp = <3>; /*4700 + val * 100*/
        sc,nx853x,fsw-freq = <7>; /*500 + val * 100*/
        sc,nx853x,pin-diag-fall-dis = <0>;
        sc,nx853x,them-flt-dis = <1>;
        sc,nx853x,tshut-dis = <1>;
        sc,nx853x,vbus-in-range-dis = <0>;
        sc,nx853x,ibus-ucp-dis = <0>;
        sc,nx853x,ibat-reg-dis = <1>;
        sc,nx853x,ibus-reg-dis = <1>;
        sc,nx853x,vbat-reg-dis = <1>;
        sc,nx853x,tdie-reg-dis = <1>;
        sc,nx853x,ibat-ocp-dg = <0>; /*0:160us 1:80us 2:320us 3:5ms*/
        sc,nx853x,ibus-ucp-fall-dg = <1>; /*0:8us 1:5ms 2:40ms 3:160ms*/
        sc,nx853x,ibus-ocp-dg = <0>; /*0:160us 1:80us 2:320us 3:5ms*/
        sc,nx853x,vbat-ovp-dg = <0>; /*0:8us 1:160us 2:320us 3:5ms*/
    };
    /*A06_V code for SR-AL7160V-01-135|SR-AL7160V-01-136 by xiongxiaoliang at 20240902 end*/
};

/*A06_V code for SR-AL7160V-01-160 by shixuanxuan at 20240827 start*/
&odm {
    gxy_psy: gxy_psy {
        compatible = "gxy, gxy_psy";
        status = "okay";
    };

    bat_id_adc: bat_id_adc {
        compatible = "gxy, bat_id_adc";
        io-channels = <&auxadc 4>;
        io-channel-names = "gxy-battid";
    };

    /*A06_V code for SR-AL7160V-01-134|SR-AL7160V-01-143 by xiongxiaoliang at 20240903 start*/
    usbpd_pm {
        compatible = "unisemipower,usbpd-pm";
        pd-bat-volt-max = <4450>;
        pd-bat-curr-max = <6000>;
        pd-bus-volt-max = <14500>;
        pd-bus-curr-max = <2770>;
        pd-fc2-taper-curr = <1500>;
        pd-fc2-one-step = <1>;
        pd-adapter-min-vol-required = <11000>;
        pd-adapter-min-curr-required = <2000>;
        pd-fc2-min-vbat-for-cp = <3300>;
        pd-fc2-second-cp-enable;
        pd-fc2-disable-sw;
    };
    /*A06_V code for SR-AL7160V-01-134|SR-AL7160V-01-143 by xiongxiaoliang at 20240903 end*/
    /*A06_V code for SR-AL7160V-01-139 by xiongxiaoliang at 20240906 start*/
    /* AFC  Fast charging */
    afc_charger: afc_charger {
        compatible = "gxy,afc_charger";
        gauge = <&mtk_gauge>;
        status = "okay";

        afc_switch_gpio_num = <6>;
        afc_switch_gpio = <&pio 6 0x0>;
        afc_data_gpio_num = <5>;
        afc_data_gpio = <&pio 5 0x0>;

        afc_start_battery_soc = <0>;
        afc_stop_battery_soc = <100>;
        afc_pre_input_current = <500000>;
        afc_charger_input_current = <1700000>;
        afc_charger_current = <2700000>;
        afc_min_charger_voltage = <4600000>;
        vbat_threshold = <4450>;
    };
    /*A06_V code for SR-AL7160V-01-139 by xiongxiaoliang at 20240906 end*/
    /*A06_V code for SR-AL7160V-01-161 by xiongxiaoliang at 20240919 start*/
    gxy_battery_ttf: gxy_battery_ttf {
        status = "okay";
        battery,ttf_dcp_charge_current = <1500>;
        battery,ttf_hv_charge_current = <2655>;
        battery,ttf_pd25_charge_current = <5000>;
        battery,ttf_pd45_charge_current = <10000>;
        battery,ttf_capacity = <4855>;
        /*fg_current soc cv_time*/
        battery,cv_data = <
            2043  82  3660
            1722  85  3422
            1502  87  3232
            1286  89  3000
            1074  91  2721
            864  93  2365
            664  95  1909
            478  97  1277
            384  98  876
            307   99  335
            230   100  0
        >;
    };
    /*A06_V code for SR-AL7160V-01-161 by xiongxiaoliang at 20240919 end*/
};
/*A06_V code for SR-AL7160V-01-160 by shixuanxuan at 20240827 end*/
